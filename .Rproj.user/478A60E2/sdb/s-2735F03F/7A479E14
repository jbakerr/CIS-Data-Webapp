{
    "collab_server" : "",
    "contents" : "service_script <- function(data){\n  \n  # This is the name I have been using for the detailed service dataset, however we may want to start using a different naming convention\n  # This is the \"Tier II and III Support Detail\" report. \n  # **** IMPORTANT ***** delete the last row that sums all hours before saving the excel file. That row will cause problems\n  #data<-('services.csv', skip = 4, header = T)\n  # xlsxFile <- system.file(\"/Volumes/GoogleDrive/My Drive/Data Files/services.xlsx\", package = \"openxlsx\")\n  data <- data.frame(apply(data, 2, function(x) gsub(\"^$|^ $\", NA, x)))\n  \n  data  <- data[,colSums(is.na(data))<nrow(data)]\n  \n  # # origin = as.Date(\"1900-01-01\", \"%Y-%m-%d\", origin = '2016-01-01')\n  # data$Entry.Date <- convertToDateTime(data$Entry.Date, origin = '2017-08-09', tx = \"EST\")\n  # data$Support.Date <- as.Date(data$Support.Date, origin = \"1900-01-01\")\n  \n  #data<-readWorksheetFromFile('services.xlsx', sheet=1, header = T, startRow = 10)\n  colnames(data)[1:2] <- c(\"Home.School\",\"Student.ID\")\n  data <- data[!is.na(data$Student.ID), ]# get rid of accidental blank rows\n  #data <- data[-nrow(data),] #removes summation row\n  \n  \n  #removing Nina's test data\n  #data <- subset(data, !data$Entered.By == \"nina\")\n  drops <- c(\"Provider.Type.2\",\"ProviderUserType3\", \"Donation.Value\", \"Total.Value.of.Time\")\n  data <- data[, ! (names(data) %in% drops)]\n  \n  \n  d <- data %>% group_by(Home.School, Entry.Date, Support.Date, Provider.Type.1, Activity, Student.Support.Category, \n                         Hours, Tier) %>% summarize(groupsize = n())\n  \n  \n  #d$groupsize[(!is.na(d$Individual.or.Group)) & d$Individual.or.Group == \"Individual\"] <- 1\n  \n  data <- merge(data, d, by = c(\"Home.School\", \"Entry.Date\", \"Support.Date\", \"Student.Support.Category\",\n                                \"Hours\", \"Tier\", \"Activity\"))\n  \n  data_test <- data\n  as.numeric.factor <- function(x) {as.numeric(levels(x))[x]}\n  \n  data$Hours <- as.numeric.factor(data$Hours)\n  # data$groupsize <- as.numeric.factor(data$groupsize)\n  \n  \n  data$hoursspent <- data$Hours/data$groupsize\n  \n  return(data)\n\n}",
    "created" : 1530737632127.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2350185803",
    "id" : "7A479E14",
    "lastKnownWriteTime" : 1530738196,
    "last_content_update" : 1530738196218,
    "path" : "~/Code/CIS2017-18/cis_webapp/services.r",
    "project_path" : "services.r",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}